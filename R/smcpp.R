# Hirundo genomic divergence landscape analysis
# smcpp.R - plot results from demographic history analysis in SMC++

### Working directory and dependencies----
setwd('~/Google Drive/My Drive/projects/hirundo_divergence_landscape/analysis/smc++/analysis/')

# Import data
twopop.rd <- read.csv('./two-pop.rustica-dimidiata.cubic-SMC.csv',header=T)
twopop.rd.r <- twopop.rd %>% filter(str_detect(label,'rustica'))
twopop.rd.d <- twopop.rd %>% filter(str_detect(label,'dimidiata'))

twopop.rn <- read.csv('./two-pop.rustica-neoxena.cubic-SMC.csv',header=T)
twopop.rn.r <- twopop.rn %>% filter(str_detect(label,'rustica'))
twopop.rn.n <- twopop.rn %>% filter(str_detect(label,'neoxena'))

twopop.rs <- read.csv('./two-pop.rustica-smithii.cubic-SMC.csv',header=T)
twopop.rs.r <- twopop.rs %>% filter(str_detect(label,'rustica'))
twopop.rs.s <- twopop.rs %>% filter(str_detect(label,'smithii'))

twopop.ra <- read.csv('./two-pop.rustica-aethiopica.cubic-SMC.csv',header=T)
twopop.ra.r <- twopop.ra %>% filter(str_detect(label,'rustica'))
twopop.ra.a <- twopop.ra %>% filter(str_detect(label,'aethiopica'))

twopop.nt <- read.csv('./two-pop.neoxena-tahitica.cubic-SMC.csv',header=T)
twopop.nt.n <- twopop.nt %>% filter(str_detect(label,'neoxena'))
twopop.nt.t <- twopop.nt %>% filter(str_detect(label,'tahitica'))

rustica <- read.csv('./rustica.cubic-SMC.csv',header=T)
aethiopica <- read.csv('./aethiopica.cubic-SMC.csv',header=T)
smithii <- read.csv('./smithii.cubic-SMC.csv',header=T)
neoxena <- read.csv('./neoxena.cubic-SMC.csv',header=T)
tahitica <- read.csv('./tahitica.cubic-SMC.csv',header=T)
dimidiata <- read.csv('./dimidiata.cubic-SMC.csv',header=T)


### Plot results for two-population and recent time single-population analyses
par(mfrow=c(1,2))
plot(twopop.rd.r$x,twopop.rd.r$y,type='l',lwd=2,col='maroon',log="xy",xlab='Time (thousands of years)',ylab='Effective population size',ylim=c(1e+05,3e+06),xlim=c(2e+04,5e+06))
lines(twopop.rd.d$x,twopop.rd.d$y,lwd=2,col='skyblue',log='xy')
lines(twopop.rn.n$x,twopop.rn.n$y,lwd=2,col='aquamarine4',log='xy')
lines(twopop.nt.t$x,twopop.nt.t$y,lwd=2,col='darkgreen',log='xy')
lines(twopop.rs.s$x,twopop.rs.s$y,lwd=2,col='darkorange3',log='xy')
lines(twopop.ra.a$x,twopop.ra.a$y,lwd=2,col='goldenrod3',log='xy')

points(x = 2e+04,y=1e+05,pch=3)
points(x = 3e+04,y=1e+05,pch=3)
points(x = 4e+04,y=1e+05,pch=3)
points(x = 6e+04,y=1e+05,pch=3)
points(x = 7e+04,y=1e+05,pch=3)
points(x = 8e+04,y=1e+05,pch=3)
points(x = 9e+04,y=1e+05,pch=3)
points(x = 2e+05,y=1e+05,pch=3)
points(x = 3e+05,y=1e+05,pch=3)
points(x = 4e+05,y=1e+05,pch=3)
points(x = 6e+05,y=1e+05,pch=3)
points(x = 7e+05,y=1e+05,pch=3)
points(x = 8e+05,y=1e+05,pch=3)
points(x = 9e+05,y=1e+05,pch=3)
points(x = 3e+06,y=1e+05,pch=3)
points(x = 4e+06,y=1e+05,pch=3)

points(x = 2e+04,y=3e+05,pch=3)
points(x = 2e+04,y=4e+05,pch=3)
points(x = 2e+04,y=6e+05,pch=3)
points(x = 2e+04,y=7e+05,pch=3)
points(x = 2e+04,y=8e+05,pch=3)
points(x = 2e+04,y=9e+05,pch=3)

### Make six panel figure of single-species histories

par(mfrow=c(2,3))
plot(rustica$x,rustica$y,type='l',lwd=2,col='maroon',log="xy",xlim=c(1e+03,5e+05),ylim=c(5e+04,3e+06),xlab='Time (years)',ylab='Effective population size')
points(x = 1e+03,y=3e+05,pch=3)
points(x = 1e+03,y=4e+05,pch=3)
points(x = 1e+03,y=6e+05,pch=3)
points(x = 1e+03,y=7e+05,pch=3)
points(x = 1e+03,y=8e+05,pch=3)
points(x = 1e+03,y=9e+05,pch=3)
points(x = 1e+03,y=9e+04,pch=3)
points(x = 1e+03,y=8e+04,pch=3)
points(x = 1e+03,y=7e+04,pch=3)
points(x = 1e+03,y=6e+04,pch=3)
points(x = 2e+03,y=1e+05,pch=3)
points(x = 3e+03,y=1e+05,pch=3)
points(x = 4e+03,y=1e+05,pch=3)
points(x = 6e+03,y=1e+05,pch=3)
points(x = 7e+03,y=1e+05,pch=3)
points(x = 8e+03,y=1e+05,pch=3)
points(x = 9e+03,y=1e+05,pch=3)
points(x = 2e+04,y=1e+05,pch=3)
points(x = 3e+04,y=1e+05,pch=3)
points(x = 4e+04,y=1e+05,pch=3)
points(x = 6e+04,y=1e+05,pch=3)
points(x = 7e+04,y=1e+05,pch=3)
points(x = 8e+04,y=1e+05,pch=3)
points(x = 9e+04,y=1e+05,pch=3)
points(x = 2e+05,y=1e+05,pch=3)
points(x = 3e+05,y=1e+05,pch=3)
points(x = 4e+05,y=1e+05,pch=3)
plot(aethiopica$x,aethiopica$y,type='l',col='goldenrod3',lwd=2,log="xy",xlim=c(1e+03,5e+05),ylim=c(5e+04,3e+06),xlab='Time (years)',ylab='Effective population size')
points(x = 1e+03,y=3e+05,pch=3)
points(x = 1e+03,y=4e+05,pch=3)
points(x = 1e+03,y=6e+05,pch=3)
points(x = 1e+03,y=7e+05,pch=3)
points(x = 1e+03,y=8e+05,pch=3)
points(x = 1e+03,y=9e+05,pch=3)
points(x = 1e+03,y=9e+04,pch=3)
points(x = 1e+03,y=8e+04,pch=3)
points(x = 1e+03,y=7e+04,pch=3)
points(x = 1e+03,y=6e+04,pch=3)
points(x = 2e+03,y=1e+05,pch=3)
points(x = 3e+03,y=1e+05,pch=3)
points(x = 4e+03,y=1e+05,pch=3)
points(x = 6e+03,y=1e+05,pch=3)
points(x = 7e+03,y=1e+05,pch=3)
points(x = 8e+03,y=1e+05,pch=3)
points(x = 9e+03,y=1e+05,pch=3)
points(x = 2e+04,y=1e+05,pch=3)
points(x = 3e+04,y=1e+05,pch=3)
points(x = 4e+04,y=1e+05,pch=3)
points(x = 6e+04,y=1e+05,pch=3)
points(x = 7e+04,y=1e+05,pch=3)
points(x = 8e+04,y=1e+05,pch=3)
points(x = 9e+04,y=1e+05,pch=3)
points(x = 2e+05,y=1e+05,pch=3)
points(x = 3e+05,y=1e+05,pch=3)
points(x = 4e+05,y=1e+05,pch=3)
plot(smithii$x,smithii$y,type='l',col='darkorange3',lwd=2,log="xy",xlim=c(1e+03,5e+05),ylim=c(5e+04,3e+06),xlab='Time (years)',ylab='Effective population size')
points(x = 1e+03,y=3e+05,pch=3)
points(x = 1e+03,y=4e+05,pch=3)
points(x = 1e+03,y=6e+05,pch=3)
points(x = 1e+03,y=7e+05,pch=3)
points(x = 1e+03,y=8e+05,pch=3)
points(x = 1e+03,y=9e+05,pch=3)
points(x = 1e+03,y=9e+04,pch=3)
points(x = 1e+03,y=8e+04,pch=3)
points(x = 1e+03,y=7e+04,pch=3)
points(x = 1e+03,y=6e+04,pch=3)
points(x = 2e+03,y=1e+05,pch=3)
points(x = 3e+03,y=1e+05,pch=3)
points(x = 4e+03,y=1e+05,pch=3)
points(x = 6e+03,y=1e+05,pch=3)
points(x = 7e+03,y=1e+05,pch=3)
points(x = 8e+03,y=1e+05,pch=3)
points(x = 9e+03,y=1e+05,pch=3)
points(x = 2e+04,y=1e+05,pch=3)
points(x = 3e+04,y=1e+05,pch=3)
points(x = 4e+04,y=1e+05,pch=3)
points(x = 6e+04,y=1e+05,pch=3)
points(x = 7e+04,y=1e+05,pch=3)
points(x = 8e+04,y=1e+05,pch=3)
points(x = 9e+04,y=1e+05,pch=3)
points(x = 2e+05,y=1e+05,pch=3)
points(x = 3e+05,y=1e+05,pch=3)
points(x = 4e+05,y=1e+05,pch=3)
plot(neoxena$x,neoxena$y,type='l',col='aquamarine4',lwd=2,log="xy",xlim=c(1e+03,5e+05),ylim=c(5e+04,3e+06),xlab='Time (years)',ylab='Effective population size')
points(x = 1e+03,y=3e+05,pch=3)
points(x = 1e+03,y=4e+05,pch=3)
points(x = 1e+03,y=6e+05,pch=3)
points(x = 1e+03,y=7e+05,pch=3)
points(x = 1e+03,y=8e+05,pch=3)
points(x = 1e+03,y=9e+05,pch=3)
points(x = 1e+03,y=9e+04,pch=3)
points(x = 1e+03,y=8e+04,pch=3)
points(x = 1e+03,y=7e+04,pch=3)
points(x = 1e+03,y=6e+04,pch=3)
points(x = 2e+03,y=1e+05,pch=3)
points(x = 3e+03,y=1e+05,pch=3)
points(x = 4e+03,y=1e+05,pch=3)
points(x = 6e+03,y=1e+05,pch=3)
points(x = 7e+03,y=1e+05,pch=3)
points(x = 8e+03,y=1e+05,pch=3)
points(x = 9e+03,y=1e+05,pch=3)
points(x = 2e+04,y=1e+05,pch=3)
points(x = 3e+04,y=1e+05,pch=3)
points(x = 4e+04,y=1e+05,pch=3)
points(x = 6e+04,y=1e+05,pch=3)
points(x = 7e+04,y=1e+05,pch=3)
points(x = 8e+04,y=1e+05,pch=3)
points(x = 9e+04,y=1e+05,pch=3)
points(x = 2e+05,y=1e+05,pch=3)
points(x = 3e+05,y=1e+05,pch=3)
points(x = 4e+05,y=1e+05,pch=3)
plot(tahitica$x,tahitica$y,type='l',col='darkgreen',lwd=2,log="xy",xlim=c(1e+03,5e+05),ylim=c(5e+04,3e+06),xlab='Time (years)',ylab='Effective population size')
points(x = 1e+03,y=3e+05,pch=3)
points(x = 1e+03,y=4e+05,pch=3)
points(x = 1e+03,y=6e+05,pch=3)
points(x = 1e+03,y=7e+05,pch=3)
points(x = 1e+03,y=8e+05,pch=3)
points(x = 1e+03,y=9e+05,pch=3)
points(x = 1e+03,y=9e+04,pch=3)
points(x = 1e+03,y=8e+04,pch=3)
points(x = 1e+03,y=7e+04,pch=3)
points(x = 1e+03,y=6e+04,pch=3)
points(x = 2e+03,y=1e+05,pch=3)
points(x = 3e+03,y=1e+05,pch=3)
points(x = 4e+03,y=1e+05,pch=3)
points(x = 6e+03,y=1e+05,pch=3)
points(x = 7e+03,y=1e+05,pch=3)
points(x = 8e+03,y=1e+05,pch=3)
points(x = 9e+03,y=1e+05,pch=3)
points(x = 2e+04,y=1e+05,pch=3)
points(x = 3e+04,y=1e+05,pch=3)
points(x = 4e+04,y=1e+05,pch=3)
points(x = 6e+04,y=1e+05,pch=3)
points(x = 7e+04,y=1e+05,pch=3)
points(x = 8e+04,y=1e+05,pch=3)
points(x = 9e+04,y=1e+05,pch=3)
points(x = 2e+05,y=1e+05,pch=3)
points(x = 3e+05,y=1e+05,pch=3)
points(x = 4e+05,y=1e+05,pch=3)
plot(dimidiata$x,dimidiata$y,type='l',col='skyblue',lwd=2,log="xy",xlim=c(1e+03,5e+05),ylim=c(5e+04,3e+06),xlab='Time (years)',ylab='Effective population size')
points(x = 1e+03,y=3e+05,pch=3)
points(x = 1e+03,y=4e+05,pch=3)
points(x = 1e+03,y=6e+05,pch=3)
points(x = 1e+03,y=7e+05,pch=3)
points(x = 1e+03,y=8e+05,pch=3)
points(x = 1e+03,y=9e+05,pch=3)
points(x = 1e+03,y=9e+04,pch=3)
points(x = 1e+03,y=8e+04,pch=3)
points(x = 1e+03,y=7e+04,pch=3)
points(x = 1e+03,y=6e+04,pch=3)
points(x = 2e+03,y=1e+05,pch=3)
points(x = 3e+03,y=1e+05,pch=3)
points(x = 4e+03,y=1e+05,pch=3)
points(x = 6e+03,y=1e+05,pch=3)
points(x = 7e+03,y=1e+05,pch=3)
points(x = 8e+03,y=1e+05,pch=3)
points(x = 9e+03,y=1e+05,pch=3)
points(x = 2e+04,y=1e+05,pch=3)
points(x = 3e+04,y=1e+05,pch=3)
points(x = 4e+04,y=1e+05,pch=3)
points(x = 6e+04,y=1e+05,pch=3)
points(x = 7e+04,y=1e+05,pch=3)
points(x = 8e+04,y=1e+05,pch=3)
points(x = 9e+04,y=1e+05,pch=3)
points(x = 2e+05,y=1e+05,pch=3)
points(x = 3e+05,y=1e+05,pch=3)
points(x = 4e+05,y=1e+05,pch=3)

# output at 6 x 9

# Add ticks at log intervals
points(x = 1e+03,y=3e+05,pch=3)
points(x = 1e+03,y=4e+05,pch=3)
points(x = 1e+03,y=6e+05,pch=3)
points(x = 1e+03,y=7e+05,pch=3)
points(x = 1e+03,y=8e+05,pch=3)
points(x = 1e+03,y=9e+05,pch=3)
points(x = 1e+03,y=9e+04,pch=3)
points(x = 1e+03,y=8e+04,pch=3)
points(x = 1e+03,y=7e+04,pch=3)
points(x = 1e+03,y=6e+04,pch=3)

# output at 4.5 x 8.5





  
  
  
  
  
  

















